### 实验总结

实现了死锁检测算法。算法涉及到的几个信息。Allocated，Needed全是存在了mutex/semaphore上，等到调用算法的时候再汇总为一个矩阵。其中Needed信息就是该mutex/semaphore的等待队列。而Allocated则是新建了一个Vec数组来记录分配到资源的线程情况。vec数组的下标表示的tid，值表示的是分配到的互斥资源的个数。

mutex/semaphore各自实现了get_count函数，用来获取剩下可用的资源个数。mutex根据lock与否决定个数。semaphore可以将count直接返回，但是需要做一定的改进，当count小于0的时候，返回0.



**本次实验用了三天的时间完成。**

### 问答作业

1. 需要回收的资源：回收各个线程的内核栈和trap上下文，回收进程的地址空间，进程拥有的共享资源，进程的文件列表；

   线程的父子关系的数据结构中会被引用，不需要回收，因为整个进程都会被回收的。

2. 第一种实现，先解锁然后尝试寻找等待队列中的线程；第二种实现，先找等待队列中的线程，如果找不到才会解锁。